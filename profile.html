<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile - GenWalls</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-analytics-compat.js"></script>
    <style>
        /* Your existing styles */
    </style>
</head>
<body>
    <div class="progress-bar"><div id="progressBar"></div></div>
    <div class="container">
        <div class="main-content">
            <div class="header">
                <!-- Empty header, will be hidden -->
            </div>
            <div id="errorMessage"></div>
            <div class="profile-section">
                <img id="profilePic" src="" alt="Profile Picture" class="profile-pic">
                <h2 id="profileName"></h2>
                <p id="profileEmail"></p>
                <p id="profileUsername"></p>
                <button id="signOutBtn" class="sign-out-btn" style="display: none;" onclick="signOut()">Sign Out</button>
            </div>
            <div class="favorites-section">
                <h3>Favorite Wallpapers</h3>
                <div class="gallery" id="gallery"></div>
            </div>
        </div>
    </div>
    <script>
        window.onload = async function () {
            const viewingUserId = localStorage.getItem('viewingUserId');
            const currentUserId = localStorage.getItem('currentUserId');

            if (!viewingUserId) {
                errorMessage.textContent = 'No profile selected.';
                setTimeout(() => {
                    window.location.href = 'home.html';
                }, 2000);
                return;
            }

            // Fetch the profile we're viewing
            const viewingUserData = await getUserData(viewingUserId);
            if (!viewingUserData) {
                errorMessage.textContent = 'Profile not found.';
                setTimeout(() => {
                    window.location.href = 'home.html';
                }, 2000);
                return;
            }

            // Update the profile UI
            profilePic.src = viewingUserData.picture || DEFAULT_PROFILE_PIC;
            profileName.innerHTML = `${viewingUserData.name || 'User'}${getVerificationBadge(viewingUserData.username)}`;
            profileEmail.textContent = viewingUserData.email || 'No email provided';
            profileUsername.textContent = `@${viewingUserData.username || 'user'}`;

            // Show sign out button only if viewing own profile
            const signOutBtn = document.getElementById('signOutBtn');
            if (viewingUserId === currentUserId) {
                signOutBtn.style.display = 'block';
            } else {
                signOutBtn.style.display = 'none';
            }

            // Display the user's favorites
            displayFavorites(viewingUserData.favorites || []);

            // Rest of your initialization code...
        };

        // Rest of your JavaScript code...
    </script>
</body>
</html>
